<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>ChatAgent</title>
  <style>
    body { background:#000; color:#0f0; font-family: monospace; }
    input, select, button { background:#020; color:#0f0; border:1px solid #060; margin:4px; }
    #log { background:#010; border:1px solid #050; padding:4px; height:300px; overflow:auto; white-space:pre-wrap; }
  </style>
</head>
<body>
  <div>
    <select id="model">
      <option value="gemini-1.5-flash">gemini-1.5-flash</option>
      <option value="gemini-1.5-pro">gemini-1.5-pro</option>
    </select>
    <input id="project_id" value="1" />
    <input id="prompt" size="60" />
    <button id="send">Send</button>
    <button id="demo">Hello World demo</button>
  </div>
  <pre id="log"></pre>
  <script>
    function append(msg){
      const el = document.getElementById('log');
      el.textContent += (el.textContent ? "\n" : "") + msg;
    }
    document.getElementById('send').onclick = async function(){
      const project_id = parseInt(document.getElementById('project_id').value, 10);
      const text = document.getElementById('prompt').value;
      const model = document.getElementById('model').value;
      const r = await fetch('/api/chat', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({project_id, text, model})});
      const data = await r.json();
      append('outer: ' + data.reply);
    };
    document.getElementById('demo').onclick = function(){
      document.getElementById('prompt').value = 'hello world';
    };
  </script>
</body>
</html>
